# K380 Function Keys Manager - 构建指南

## 🎯 为什么需要构建正式版本？

您目前运行的是**开发版本**，在开发模式下：
- ❌ 无法设置开机自启动（会报错）
- ❌ 每次需要重新输入密码
- ❌ 路径和权限可能不稳定

构建**正式版本**后：
- ✅ 可以正常设置开机自启动
- ✅ 密码缓存5分钟，减少输入次数
- ✅ 权限和路径更稳定

## 🛠️ 构建步骤

### 1. 确保所有依赖已安装

```bash
npm install
```

### 2. 构建二进制文件（如果还没有）

```bash
# 构建 k380 相关二进制文件
./build_improved.sh
```

### 3. 构建 Electron 应用

```bash
# 构建正式版本
npm run build
```

构建完成后，您会在 `dist` 文件夹中找到：
- `K380 Function Keys Manager-1.0.0-arm64.dmg` (Apple Silicon)
- `K380 Function Keys Manager-1.0.0-x64.dmg` (Intel)
- `K380 Function Keys Manager-1.0.0-mac.zip` (通用版本)

### 4. 安装正式版本

1. 打开生成的 `.dmg` 文件
2. 将 `K380 Function Keys Manager.app` 拖到 `Applications` 文件夹
3. 从 `Applications` 文件夹启动应用

## 🎉 正式版本的优势

### 密码管理改进
- **智能缓存**：密码缓存5分钟，大大减少输入次数
- **安全处理**：应用退出时自动清理密码缓存
- **错误处理**：密码错误时自动清除缓存，提示重新输入

### 开机自启动支持
- **完整支持**：正式版本完全支持 macOS 开机自启动
- **Launch Agent**：使用 macOS 标准的 Launch Agent 机制
- **隐式启动**：启动时不显示窗口，直接在系统托盘运行

### 权限和稳定性
- **代码签名**：正式版本经过适当的代码签名
- **权限配置**：包含完整的 macOS 权限配置
- **路径稳定**：固定的应用路径，避免开发模式的变化

## 🚨 常见问题

### Q: 构建时提示缺少图标文件
**A:** 可以忽略图标警告，应用仍然可以正常构建和运行。

### Q: 构建的应用无法启动
**A:** 确保您已经运行了 `./build_improved.sh` 来构建必要的二进制文件。

### Q: 权限问题仍然存在
**A:** 正式版本安装后，需要重新添加到系统设置的"输入监控"权限中。

## 📱 使用正式版本

1. **安装后首次启动**：应用会显示主窗口和权限设置指南
2. **系统托盘**：应用会在系统托盘中显示，右键查看所有功能
3. **开机自启动**：在托盘菜单中可以正常设置开机自启动
4. **密码输入**：只需在首次或5分钟后重新输入密码

## 🔧 开发vs正式版本对比

| 功能 | 开发版本 | 正式版本 |
|------|----------|----------|
| 基本功能 | ✅ | ✅ |
| 开机自启动 | ❌ | ✅ |
| 密码缓存 | ❌ | ✅ (5分钟) |
| 权限稳定性 | ⚠️ | ✅ |
| 性能 | 较慢 | 更快 |
| 文件大小 | 较大 | 较小 |

---

**建议**：如果您需要开机自启动功能，强烈建议构建并使用正式版本！ 